\documentclass{article}
\title{Key parts of the code}
\begin{document}
\maketitle

The following items come into \texttt{var.apc.plot.fit} from earlier parts of the code (via \texttt{apc.fit.indiv})
\begin{itemize}
\item To control the choice of submodel, use \texttt{slopes} and \texttt{difdif}. Each is a three-length binary vector.
\item \texttt{xi.dim} indicates the number of APC matrix elements included.
\item \texttt{coefficients.canonical} is a matrix with a row for each included element of the APC matrix. There are four columns. The first is the estimated coefficient on that element, the second the standard error (square root of covariance), the third the t-statistic, and the fourth the p-value. The third and fourth are calculated from the first and second only. The coefficients come from \texttt{summary.glm(fit)\$coefficients} and the covariance from \texttt{summary.glm(fit)\$cov.scaled}. NOTE: \texttt{cov.scaled} is the standard covariance unless the dispersion is specified to differ from 1.
\item \texttt{index.age} identifies which elements of the matrix of coefficients are associated with age double differences. It uses \texttt{age.max}, which is the same as $I$ in the math. This also applies for period and cohort.
\item \texttt{dates} is a stacked vector of the labels for ages, periods, and cohorts. This uses \texttt{age1} and similar, which are the start points of the real values.
\item \texttt{per.odd} is true/false, and \texttt{U} is as defined in the math. \texttt{per.zero} is $L$
\end{itemize}

The following items are generated within \texttt{var.apc.plot.fit} by \texttt{apc.identify}
\begin{itemize}
\item Derived values \texttt{det.max}, \texttt{det.sub}, etc. are of unclear purpose. They are used in the creation of \texttt{index.age.max}, \texttt{index.age.sub}, etc. which seem to indicate which elements of a list are age double-differences, period double-differences, slopes, etc. \texttt{dates.max} etc. give the true dates associated with each, and they use \texttt{xi.max} etc. which were generated earlier and seem to be a dimensional vector. 
\item In each of the sets of derived values there are three types: \texttt{.max}, \texttt{.sub}, and \texttt{.dif} which seem to be the "maximal" model, the submodel, and the differences respectively. However it's not entirely clear HOW.
\item \texttt{function.ssdd} is constructed, and applied to each of age, period, and cohort separetly. Once applied these are combined into \texttt{m.ssdd} which is then multiplied by \texttt{coefficients} to get \texttt{coefficients.ssdd} (and \texttt{names.ssdd} is then used to generate row names). The equivalent is done for \texttt{function.detrend}, \texttt{m.detrend}, etc.
\item The covariances are generated by pre- and post-multiplying \texttt{covariance} by either \texttt{m.ssdd} or \texttt{m.detrend} and taking the square root, then substituting these for the second column of the coefficients matrix (question: are these the same values in either case?). Some adjustments are made for "ad hoc identified" elements which have NA variance. 
\item There is also the \texttt{demean} and the \texttt{dif} representation. Both are constructed by applying a repetitive formulation to age, period, and cohort, and then combining them into \texttt{m.demean} and \texttt{m.dif}. We then construct \texttt{coefficients.demean} by multiplying \texttt{m.demean * coefficients.detrend}, and \texttt{coefficients.dif} from \texttt{m.dif} and \texttt{coefficients.detrend}. The covariances are constructed in the same way  
\end{itemize}

The following elements are interior to \texttt{var.apc.plot.fit}
\begin{itemize}
\item \texttt{v.do.plot} indicates which subplots are desired
\item \texttt{v.main.sub} gives titles to subplots
\item \texttt{l.dates} is a list of vectors indicating the horizontal axes for the subplots. \texttt{l.coefficients} is a list of vectors of the coefficients to be displayed in each subplot. For the first three plots,\texttt{coefficients.canonical} is used (though seems to be only one row?). \texttt{coefficients.sum.sum} is assigned to be either \texttt{coefficients.ssdd} or \texttt{coefficients.detrend} depending on earlier specification.
\item \texttt{v.xlab} gives the labels for the x-axes
\item All of the above are generated in a separate part of the code in the case that the type of plot requested is \texttt{dif} rather than \texttt{detrend} or \texttt{ssdd}. There are a few differences, the main substantive difference occurring in the definition of \texttt{l.coefficients}
\item There is an internal function \texttt{function.plot.est.sdv} which is used for each subplot. Sets dates on the x-axis, coefficient estimates on the y-axis. Important things to note: \texttt{scale} which if not zero means that the standard deviations will be scaled exponentially before lines are drawn. Option \texttt{sdv.at.zero} which determines whether the standard deviation lines are plotted around the estimate or not. Standard deviation is taken to be the second column of \texttt{coefficients}. \texttt{tau} determines whether the standard error lines are shown at all (they are not under mixed parameterisation)
\item As expected, it is \texttt{l.coefficients} that is used for the plotting

\end{itemize}
\end{document}